<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Flight Recommender • Graph (PPR) + Text (MMR)</title>
  <link rel="stylesheet" href="style.css?v=2025-11-15"/>
</head>
<body>
  <header class="topbar">
    <h1>Flight Recommender</h1>
    <p class="muted">Tab A: RouteGraph-PPR + constraints • Tab B: Text (reviews → vectors) + MMR. 100% client-side.</p>
  </header>

  <main class="wrap">
    <section class="panel panel-controls">
      <div class="grid grid-4">
        <div>
          <label>Origin</label>
          <select id="origin"></select>
        </div>
        <div>
          <label>Destination</label>
          <select id="destination"></select>
        </div>
        <div>
          <label>Date</label>
          <input type="date" id="date"/>
        </div>
        <div>
          <label>Depart (local)</label>
          <input type="time" id="time" value="09:00"/>
        </div>
      </div>

      <div class="grid grid-4">
        <div>
          <label>Stops</label>
          <select id="stops">
            <option value="0">Nonstop only</option>
            <option value="1" selected>≤ 1 stop</option>
          </select>
        </div>
        <div>
          <label>Alliance</label>
          <select id="alliance">
            <option value="">Any</option>
            <option value="SkyTeam">SkyTeam</option>
            <option value="Star Alliance">Star Alliance</option>
            <option value="Oneworld">Oneworld</option>
          </select>
        </div>
        <div>
          <label>Preference</label>
          <input type="range" id="tradeoff" min="0" max="1" step="0.05" value="0.5"/>
          <small class="muted"><span id="tradeoffLabel">Balanced</span> (0=Fastest, 1=Cheapest)</small>
        </div>
        <div>
          <label>Free-text rules</label>
          <input id="query" placeholder='e.g. "no red-eye, arrive before 16:00, prefer SkyTeam"'/>
        </div>
      </div>

      <div class="controls-row">
        <button id="btnLoad">Load Data</button>
        <button id="btnRunGraph" disabled>Run (Tab A)</button>
        <button id="btnRunText" disabled>Run (Tab B)</button>
        <span id="status" class="muted">Status: waiting…</span>
      </div>
    </section>

    <section class="tabs">
      <nav class="tabbar">
        <button class="tab active" data-tab="graph">Tab A — Graph (RouteGraph-PPR)</button>
        <button class="tab" data-tab="text">Tab B — Text (Reviews + MMR)</button>
      </nav>

      <section id="tab-graph" class="tabpane active">
        <div class="split">
          <div class="card">
            <h3>Top-10 (PPR + Constraints)</h3>
            <table id="graphTable">
              <thead><tr>
                <th>#</th><th>Itinerary</th><th>Airline(s)</th><th>Stops</th>
                <th>Depart → Arrive</th><th>Dur.</th><th>Price</th><th>Score</th><th>Why</th>
              </tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="card">
            <h3>Route Graph (popularity view)</h3>
            <canvas id="graphCanvas" width="640" height="420"></canvas>
            <p class="muted">Node size ~ degree; edge alpha ~ frequency.</p>
          </div>
        </div>
      </section>

      <section id="tab-text" class="tabpane">
        <div class="split">
          <div class="card">
            <h3>Top-10 (Text MMR + Constraints)</h3>
            <table id="textTable">
              <thead><tr>
                <th>#</th><th>Itinerary</th><th>Airline</th><th>Stops</th>
                <th>Depart → Arrive</th><th>Dur.</th><th>Price</th><th>Score</th><th>Why</th>
              </tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="card">
            <h3>Review Embeddings (sample)</h3>
            <canvas id="embCanvas" width="640" height="420"></canvas>
            <p class="muted">Uses 2-D from provided vectors or a radial layout if derived.</p>
          </div>
        </div>
      </section>
    </section>
  </main>

  <footer class="muted foot">
    <p>Deploy: push to GitHub → Settings → Pages → Deploy from branch (root). Data go in <code>/data</code>.</p>
  </footer>

  <!-- Single module entry; it imports the others -->
  <script type="module" src="app.js"></script>
</body>
</html>
