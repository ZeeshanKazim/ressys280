<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>RouteGraph-RAG · CP2 Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="app-root" class="app-root">
      <!-- Top bar -->
      <header class="app-header">
        <div class="header-main">
          <h1 class="app-title">RouteGraph-RAG</h1>
          <p class="app-tagline">
            Constraint-Aware Two-Tower Flight Recommender with Review-Text Signals
          </p>
        </div>
        <div class="header-pill">
          CHECKPOINT 2 · CORE FUNCTIONALITY INTEGRATED
        </div>
      </header>

      <!-- Loading / error indicators -->
      <div id="loading-indicator" class="status-message" style="display: none;">
        Loading flight data, route graph, and reviews…
      </div>
      <div id="error-indicator" class="status-message status-error" style="display: none;">
        Something went wrong while loading data. Please refresh the page.
      </div>

      <main class="app-main">
        <!-- Left: search & constraints -->
        <aside class="controls-pane">
          <h2 class="pane-title">Search &amp; Constraints</h2>
          <form class="constraints-form">
            <!-- Origin -->
            <div class="form-field">
              <label for="origin-select">Origin</label>
              <select id="origin-select"></select>
            </div>

            <!-- Destination -->
            <div class="form-field">
              <label for="destination-select">Destination</label>
              <select id="destination-select"></select>
            </div>

            <!-- Max price -->
            <div class="form-field">
              <label for="max-price-input">Max price (₽)</label>
              <input
                id="max-price-input"
                type="number"
                min="0"
                placeholder="e.g. 8000"
              />
              <small class="field-hint">
                Amount in Russian rubles (₽). Leave blank for no price limit.
              </small>
            </div>

            <!-- Max stops -->
            <div class="form-field">
              <label for="max-stops-select">Max stops</label>
              <select id="max-stops-select">
                <option>Any</option>
                <option>Non-stop only</option>
                <option>Up to 1 stop</option>
                <option>Up to 2 stops</option>
              </select>
            </div>

            <!-- Avoid red-eye -->
            <div class="form-field form-field-inline">
              <input
                id="avoid-redeye-checkbox"
                type="checkbox"
              />
              <label for="avoid-redeye-checkbox">
                Avoid red-eye flights
              </label>
            </div>

            <!-- Alliance preference -->
            <div class="form-field">
              <label for="alliance-select">Prefer alliance</label>
              <select id="alliance-select">
                <option>No preference</option>
                <option>SkyTeam</option>
                <option>Star Alliance</option>
                <option>Oneworld</option>
                <option>None</option>
              </select>
              <small class="field-hint">
                Hybrid model boosts flights in your preferred alliance.
              </small>
            </div>

            <!-- Button -->
            <div class="form-actions">
              <button id="recommend-button" type="button">
                Recommend flights
              </button>
            </div>

            <p class="form-footnote">
              All scoring runs locally in your browser using precomputed
              XGBoost scores, route-graph features, and airline review statistics.
            </p>
          </form>
        </aside>

        <!-- Right: recommendations -->
        <section class="results-pane">
          <!-- Banner for constraint fallback -->
          <div id="constraints-banner" class="constraints-banner"></div>

          <div class="results-grid">
            <!-- Baseline column -->
            <section class="results-column">
              <h2 class="results-title">
                Baseline (XGBoost / Two-Tower)
              </h2>
              <p class="results-subtitle">
                Ranked using tabular features only: price, duration, stops, and timing.
              </p>
              <div id="baseline-results" class="results-list"></div>
            </section>

            <!-- Hybrid column -->
            <section class="results-column">
              <h2 class="results-title">
                RouteGraph-RAG (Graph + Reviews)
              </h2>
              <p class="results-subtitle">
                Baseline score combined with route-graph popularity, connectivity,
                airline reviews, and your alliance preference.
              </p>
              <div id="hybrid-results" class="results-list"></div>
            </section>
          </div>
        </section>
      </main>
    </div>

    <!-- App entry -->
    <script type="module" src="./app.js"></script>
  </body>
</html>
